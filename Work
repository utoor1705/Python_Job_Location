import pandas as pd
import numpy as np
import nltk
from nltk.tokenize import word_tokenize
from nltk.tokenize.treebank import TreebankWordDetokenizer

from geotext import GeoText
print("P1")

df = pd.read_csv('data_full.csv', engine='python', encoding='utf-8', error_bad_lines=False)

#Job File
df1 = pd.read_csv('occupation-list.csv')

print("P2")

#Remove unamed column
df = df.loc[:, ~df.columns.str.contains('^Unnamed')]

# Remove all titles with NAN
title_data = df[df['Title'].notnull()].copy()

# Create a new column for Location
title_data["Occupation"] = np.nan


print("P3")

for i in range(len(title_data['Title'])):
    for j in df1['Occupation']:
        if j.lower() in title_data['Title'].values[i].lower():
            title_data["Occupation"].values[i] = 1
        else:
            title_data["Occupation"].values[i] = 0

print("P7")
output = title_data.to_csv('Location.csv', index = None, header=True)
